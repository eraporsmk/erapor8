import{d as h,a as G,t as he}from"./mixins-Bwtc0noR.js";import{_ as De}from"./ConfirmDialog-DQpHDvI5.js";import{_ as Pe}from"./DefaultDialog-NgUt_xxV.js";import{_ as Ce}from"./AppTextarea-BDWbHqjA.js";import{_ as Te}from"./TablePagination-CA3yM59_.js";import{_ as we}from"./AppTextField-C--9ree2.js";import{_ as Fe}from"./AppSelect-DbtRumVz.js";import{u as Ue,c as Re}from"./createUrl-CuA4HU6Y.js";import{$ as F}from"./api-Bn4vDLHK.js";import{V as Be,a as Ke,c as $e,b as Se}from"./VCard-CmztIyif.js";import{V as le}from"./VDivider-ClZLxXRM.js";import{V as Ae}from"./VSpacer-CtxF1wRa.js";import{r as i,G as Ne,w as te,c as g,b as a,e as t,m as l,a2 as H,a as Ie,o as u,t as _,d as b,aa as J,F as y,v as D,y as V,f as j,$ as N}from"./main-BdF1xdd5.js";import{V as Me}from"./VDataTableServer-B7UDrnyY.js";import{V as se}from"./VChip-B9uiW2RG.js";import{V as qe}from"./VTooltip-BVMfVo_W.js";import{V as Oe}from"./VMenu-Bq_zZrBz.js";import{V as Qe,a as oe,b as ne}from"./VList-BoHYvska.js";import{V as k,a as r}from"./VRow-CHmQbx7b.js";import{V as ze}from"./VFileInput-Cekt2d6n.js";import"./VDialog-Eawq-wiH.js";import"./VOverlay-UpbHjJ0c.js";import"./forwardRefs-DWGaNmQL.js";import"./VImg-Cb-uhMY7.js";import"./DialogCloseBtn-D5HQdd8i.js";import"./VLabel-ka-Bfzm0.js";import"./VSelectionControl-9DB19zEX.js";import"./VAvatar-DnbWgyQQ.js";import"./index-BxkgbwWS.js";/* empty css              */import"./VTable-C_eatZJQ.js";import"./filter-CPOIRO1y.js";const Ee={class:"me-3 d-flex gap-3"},Le={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},Ge={style:{"inline-size":"15.625rem"}},He={key:0},Je={key:1},We={key:2},Xe={key:3},Ua={__name:"perencanaan",setup(Ye){const I=i(),U=i(!1),M=i(!1),q=i(!1),m=i({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null,page:1,itemsPerPage:10,searchQuery:"",sortby:"updated_at",sortbydesc:"DESC"}),ie=[{key:"mata_pelajaran_id",title:"Mata Pelajaran"},{key:"rombel",title:"rombel",align:"center",sortable:!1},{key:"kd_cp",title:"CP/KD",sortable:!1},{key:"kelas",title:"Fase/Tingkat",sortable:!1,align:"center"},{key:"deskripsi",title:"Deskripsi"},{key:"actions",title:"Aksi",align:"center",sortable:!1,nowrap:!0}],W=i([]),O=i(0);i([]),i([]);const Q=i(!1);Ne(async()=>{await z()}),te(m,async()=>{await z()},{deep:!0}),te(()=>m.value.searchQuery,()=>{m.value.page=1});const re=d=>{var e,o;m.value.sortby=(e=d[0])==null?void 0:e.key,m.value.sortbydesc=(o=d[0])==null?void 0:o.order},z=async()=>{Q.value=!0;try{let e=(await Ue(Re("/referensi/tujuan-pembelajaran",{query:{user_id:h.user_id,guru_id:h.guru_id,sekolah_id:h.sekolah_id,semester_id:G.semester_id,periode_aktif:G.nama,tingkat:m.value.tingkat,rombongan_belajar_id:m.value.rombongan_belajar_id,q:m.value.searchQuery,page:m.value.page,per_page:m.value.itemsPerPage,sortby:m.value.sortby,sortbydesc:m.value.sortbydesc}}))).data;W.value=e.value.data.data,O.value=e.value.data.total}catch(d){console.error(d)}finally{Q.value=!1}},R=i(!1),P=i({color:null,title:null,text:null});i({tingkat:null,rombongan_belajar_id:null,pembelajaran_id:null});const C=i(!1),x=i(!1),B=i(!1),K=i(!1),$=i(!1),v=i(!1),S=i(""),A={semester_id:G.semester_id,user_id:h.user_id,guru_id:h.guru_id,sekolah_id:h.sekolah_id},n=i({tp_id:null,tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,cp_id:null,kd_id:null,template_excel:null,deskripsi:null,merdeka:!1}),c=i({tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,cp_id:null,kd_id:null,template_excel:null,deskripsi:null}),T=i(),X=i(),E=async(d,e)=>{n.value.tp_id=e.tp_id,T.value=d,d=="mapping"?(v.value=!0,S.value="Petakan TP ke Rombongan Belajar"):d=="edit"?(v.value=!0,n.value.deskripsi=e.deskripsi,S.value="Ubah Deskripsi Kompetensi Dasar"):(R.value=!0,X.value="Tindakan ini tidak dapat dikembalikan!")},L=i([]),Y=i([]),Z=i([]),ee=i([]),de=()=>{T.value="add",v.value=!0,S.value="Tambah Data Tujuan Pembelajaran"},me=async d=>{d&&await F("/referensi/tujuan-pembelajaran/delete",{method:"POST",body:n.value,onResponse({response:e}){let o=e._data;getItem.value=null,v.value=!1,C.value=!0,P.value=o}})},ue=async()=>{await z()},w=i(),pe=async()=>{const e={...{aksi:T.value},...A,...n.value},o=new FormData;o.append("aksi",e.aksi),o.append("guru_id",e.guru_id),o.append("sekolah_id",e.sekolah_id),o.append("semester_id",e.semester_id),o.append("user_id",e.user_id),o.append("cp_id",e.cp_id?e.cp_id:""),o.append("kd_id",e.kd_id?e.kd_id:""),o.append("deskripsi",e.deskripsi?e.deskripsi:""),o.append("mata_pelajaran_id",e.mata_pelajaran_id?e.mata_pelajaran_id:""),o.append("pembelajaran_id",w.value),o.append("rombongan_belajar_id",e.rombongan_belajar_id?e.rombongan_belajar_id:""),o.append("template_excel",e.template_excel?e.template_excel:""),o.append("tingkat",e.tingkat?e.tingkat:""),o.append("tp_id",e.tp_id?e.tp_id:""),await F("/referensi/tujuan-pembelajaran/save",{method:"POST",body:o,onResponse({response:f}){let p=f._data;p.errors?c.value=p.errors:(w.value=null,U.value=!1,v.value=!1,C.value=!0,P.value=p,n.value={tp_id:null,tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,cp_id:null,kd_id:null,template_excel:null,deskripsi:null,merdeka:!1},c.value={tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,cp_id:null,kd_id:null,template_excel:null,deskripsi:null})}})},_e=async d=>{d?await pe():(n.value={tp_id:null,tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,cp_id:null,kd_id:null,template_excel:null,deskripsi:null,merdeka:!1},c.value={tingkat:null,rombongan_belajar_id:null,mata_pelajaran_id:null,cp_id:null,kd_id:null,template_excel:null,deskripsi:null})},ge=async d=>{if(d){x.value=!0;const o={...{data:"rombel",mapping:1},...A,...n.value};await F("/referensi/get-data",{method:"POST",body:o,onResponse({response:f}){let p=f._data;L.value=p,x.value=!1}})}},ce=async d=>{if(d){B.value=!0;const o={...{data:"mapel"},...A,...n.value};await F("/referensi/get-data",{method:"POST",body:o,onResponse({response:f}){let p=f._data;Y.value=p.mapel,n.value.merdeka=p.merdeka,B.value=!1}})}},fe=async d=>{if(M.value=!1,q.value=!1,d){K.value=!0,$.value=!0;const o={...{data:"cp_kd"},...A,...n.value};await F("/referensi/get-data",{method:"POST",body:o,onResponse({response:f}){let p=f._data;Z.value=p.cp,ee.value=p.kd,w.value=p.pembelajaran_id,p.cp.length&&(M.value=!0),p.kd.length&&(q.value=!0),$.value=!1,K.value=!1}})}},be=()=>{U.value=!0,I.value="/downloads/template-tp/"+n.value.cp_id+"/"+n.value.rombongan_belajar_id+"/"+w.value},ke=()=>{U.value=!0,I.value="/downloads/template-tp/"+n.value.kd_id+"/"+n.value.rombongan_belajar_id+"/"+w.value},ve=d=>{let e=d.map(f=>f.rombongan_belajar.nama);return[...new Set(e)].join(", ")};return(d,e)=>{const o=Fe,f=we,p=Ie("IconBtn"),ye=Te,Ve=Ce,je=Pe,xe=De;return u(),g("section",null,[a(Be,{class:"mb-6"},{default:t(()=>[a(Ke,{class:"pb-4"},{default:t(()=>[a($e,null,{default:t(()=>e[14]||(e[14]=[_("Rencana Penilaian UKK")])),_:1})]),_:1}),a(le),a(Se,{class:"d-flex flex-wrap gap-4"},{default:t(()=>[b("div",Ee,[a(o,{modelValue:l(m).itemsPerPage,"onUpdate:modelValue":e[0]||(e[0]=s=>l(m).itemsPerPage=s),items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"}],style:{"inline-size":"6.25rem"}},null,8,["modelValue"])]),a(Ae),b("div",Le,[b("div",Ge,[a(f,{modelValue:l(m).searchQuery,"onUpdate:modelValue":e[1]||(e[1]=s=>l(m).searchQuery=s),placeholder:"Cari Data"},null,8,["modelValue"])]),a(J,{"prepend-icon":"tabler-plus",onClick:de},{default:t(()=>e[15]||(e[15]=[_(" Tambah Data ")])),_:1})])]),_:1}),a(le),a(Me,{items:l(W),"server-items-length":l(O),headers:ie,options:l(m),loading:l(Q),"loading-text":"Loading...","onUpdate:sortBy":re},{"item.mata_pelajaran_id":t(({item:s})=>[s.cp?(u(),g(y,{key:0},[_(D(s.cp.mata_pelajaran.nama),1)],64)):(u(),g(y,{key:1},[_(D(s.kd.mata_pelajaran.nama),1)],64))]),"item.rombel":t(({item:s})=>[_(D(ve(s.tp_mapel)),1)]),"item.kd_cp":t(({item:s})=>[s.cp?(u(),g(y,{key:0},[_(D(s.cp.elemen),1)],64)):(u(),g(y,{key:1},[_(D(s.kd.kompetensi_dasar),1)],64))]),"item.kelas":t(({item:s})=>[s.cp?(u(),g(y,{key:0},[_(D(s.cp.fase),1)],64)):(u(),g(y,{key:1},[s.kelas_10?(u(),g("span",He,"10")):V("",!0),s.kelas_11?(u(),g("span",Je," 11")):V("",!0),s.kelas_12?(u(),g("span",We," 12")):V("",!0),s.kelas_13?(u(),g("span",Xe," 13")):V("",!0)],64))]),"item.status":t(({item:s})=>[s.aktif?(u(),j(se,{key:0,size:"x-small",color:"success",variant:"elevated"},{default:t(()=>e[16]||(e[16]=[_(" Aktif ")])),_:1})):(u(),j(se,{key:1,size:"x-small",color:"error",variant:"elevated"},{default:t(()=>e[17]||(e[17]=[_(" Non Aktif ")])),_:1}))]),"item.actions":t(({item:s})=>[a(p,{onClick:ae=>E("mapping",s)},{default:t(()=>[a(qe,{activator:"parent",location:"top"},{default:t(()=>e[18]||(e[18]=[_(" Mapping Rombel ")])),_:1}),a(N,{icon:"tabler-copy"})]),_:2},1032,["onClick"]),a(J,{icon:"",variant:"text",color:"medium-emphasis"},{default:t(()=>[a(N,{icon:"tabler-dots-vertical"}),a(Oe,{activator:"parent"},{default:t(()=>[a(Qe,null,{default:t(()=>[a(oe,{onClick:ae=>E("edit",s)},{prepend:t(()=>[a(N,{icon:"tabler-pencil"})]),default:t(()=>[a(ne,null,{default:t(()=>e[19]||(e[19]=[_("Ubah Data")])),_:1})]),_:2},1032,["onClick"]),a(oe,{onClick:ae=>E("hapus",s)},{prepend:t(()=>[a(N,{icon:"tabler-trash"})]),default:t(()=>[a(ne,null,{default:t(()=>e[20]||(e[20]=[_("Hapus Data")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),bottom:t(()=>[a(ye,{page:l(m).page,"onUpdate:page":e[2]||(e[2]=s=>l(m).page=s),"items-per-page":l(m).itemsPerPage,"total-items":l(O)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items","server-items-length","options","loading"])]),_:1}),a(je,{isDialogVisible:l(v),"onUpdate:isDialogVisible":e[11]||(e[11]=s=>H(v)?v.value=s:null),"dialog-title":l(S),errors:l(c),onConfirm:_e},{content:t(()=>[a(k,null,{default:t(()=>[l(T)=="edit"?(u(),j(r,{key:0,cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[21]||(e[21]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"deskripsi"},"Deskripsi",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(Ve,{modelValue:l(n).deskripsi,"onUpdate:modelValue":e[3]||(e[3]=s=>l(n).deskripsi=s),placeholder:"Deskripsi Tujuan Pembelajaran","auto-grow":"","error-messages":l(c).deskripsi},null,8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})):(u(),g(y,{key:1},[a(r,{cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[22]||(e[22]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"tingkat"},"Tingkat Kelas",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(o,{modelValue:l(n).tingkat,"onUpdate:modelValue":[e[4]||(e[4]=s=>l(n).tingkat=s),ge],placeholder:"== Pilih Tingkat kelas ==",items:"tingkatKelas"in d?d.tingkatKelas:l(he),clearable:"","clear-icon":"tabler-x","error-messages":l(c).tingkat},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1})]),_:1}),l(T)=="add"?(u(),g(y,{key:0},[a(r,{cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[23]||(e[23]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(o,{modelValue:l(n).rombongan_belajar_id,"onUpdate:modelValue":[e[5]||(e[5]=s=>l(n).rombongan_belajar_id=s),ce],placeholder:"== Pilih Rombongan Belajar == ",items:l(L),clearable:"","clear-icon":"tabler-x","item-value":"rombongan_belajar_id","item-title":"nama",loading:l(x),disabled:l(x),"error-messages":l(c).rombongan_belajar_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),a(r,{cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[24]||(e[24]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"mata_pelajaran_id"},"Mata Pelajaran",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(o,{modelValue:l(n).mata_pelajaran_id,"onUpdate:modelValue":[e[6]||(e[6]=s=>l(n).mata_pelajaran_id=s),fe],placeholder:"== Pilih Mata Pelajaran ==",items:l(Y),clearable:"","clear-icon":"tabler-x","item-value":"mata_pelajaran_id","item-title":"nama_mata_pelajaran",loading:l(B),disabled:l(B),"error-messages":l(c).mata_pelajaran_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}),l(M)?(u(),j(r,{key:0,cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[25]||(e[25]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"cp_id"},"Capaian Pembelajaran (CP)",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(o,{modelValue:l(n).cp_id,"onUpdate:modelValue":[e[7]||(e[7]=s=>l(n).cp_id=s),be],placeholder:"== Pilih Capaian Pembelajaran (CP) ==",items:l(Z),clearable:"","clear-icon":"tabler-x","item-value":"cp_id","item-title":"deskripsi",loading:l(K),disabled:l(K),"error-messages":l(c).cp_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1})):V("",!0),l(q)?(u(),j(r,{key:1,cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[26]||(e[26]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"kd_id"},"Kompetensi Dasar (KD)",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(o,{modelValue:l(n).kd_id,"onUpdate:modelValue":[e[8]||(e[8]=s=>l(n).kd_id=s),ke],placeholder:"== Pilih Capaian Pembelajaran (CP) ==",items:l(ee),clearable:"","clear-icon":"tabler-x","item-value":"kd_id","item-title":"kompetensi_dasar",loading:l($),disabled:l($),"error-messages":l(c).kd_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1})):V("",!0),l(U)?(u(),j(r,{key:2,cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[27]||(e[27]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"template_excel"},"Template Excel",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"6"},{default:t(()=>[a(ze,{id:"template_excel",modelValue:l(n).template_excel,"onUpdate:modelValue":e[9]||(e[9]=s=>l(n).template_excel=s),"error-messages":l(c).template_excel,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",label:"Unggah Template Excel"},null,8,["modelValue","error-messages"])]),_:1}),a(r,{cols:"6"},{default:t(()=>[a(J,{color:"primary",class:"ms-3",block:"",href:l(I),target:"_blank"},{default:t(()=>e[28]||(e[28]=[_(" Unduh Template TP ")])),_:1},8,["href"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):V("",!0)],64)):(u(),j(r,{key:1,cols:"12"},{default:t(()=>[a(k,{"no-gutters":""},{default:t(()=>[a(r,{cols:"12",md:"3",class:"d-flex align-items-center"},{default:t(()=>e[29]||(e[29]=[b("label",{class:"v-label text-body-2 text-high-emphasis",for:"rombongan_belajar_id"},"Rombongan Belajar",-1)])),_:1}),a(r,{cols:"12",md:"9"},{default:t(()=>[a(o,{modelValue:l(n).rombongan_belajar_id,"onUpdate:modelValue":e[10]||(e[10]=s=>l(n).rombongan_belajar_id=s),placeholder:"== Pilih Rombongan Belajar == ",items:l(L),chips:"",multiple:"","closable-chips":"","item-value":"rombongan_belajar_id","item-title":"nama",loading:l(x),disabled:l(x),"error-messages":l(c).rombongan_belajar_id},null,8,["modelValue","items","loading","disabled","error-messages"])]),_:1})]),_:1})]),_:1}))],64))]),_:1})]),_:1},8,["isDialogVisible","dialog-title","errors"]),a(xe,{isDialogVisible:l(R),"onUpdate:isDialogVisible":e[12]||(e[12]=s=>H(R)?R.value=s:null),isNotifVisible:l(C),"onUpdate:isNotifVisible":e[13]||(e[13]=s=>H(C)?C.value=s:null),"confirmation-question":"Apakah Anda yakin?","confirmation-text":l(X),"confirm-color":l(P).color,"confirm-title":l(P).title,"confirm-msg":l(P).text,onConfirm:me,onClose:ue},null,8,["isDialogVisible","isNotifVisible","confirmation-text","confirm-color","confirm-title","confirm-msg"])])}}};export{Ua as default};
