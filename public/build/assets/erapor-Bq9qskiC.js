import{$ as o}from"./mixins-rZl4ACSd.js";import{_ as R}from"./DialogCloseBtn-CwR_--oq.js";import{ax as M,H as U,ay as j,Y as k,r as D,a as I,c as _,o as g,b as l,e as n,d as e,v as i,m as s,t,a1 as L,f as E,l as H,F as q,h as F,a3 as G}from"./main-qkHrXkc4.js";import{S as J}from"./sweetalert2-z6gKu1nJ.js";import{u as Y}from"./useApi-Dp9jxlMN.js";import{c as z}from"./createUrl-DPMdrIhE.js";import{$ as O}from"./api-DEnPzuxT.js";import{a as w,V as x}from"./VRow-SRN4MEaa.js";import{V as y}from"./VCard-DLmDpUr4.js";import{V as A}from"./VTable-CDN-6S4R.js";import{V as K}from"./VCardText-GlWye268.js";import{V as S}from"./VAlert-BrbmkTSA.js";import{V as W}from"./VDialog-D5oZ08uU.js";import"./index-9rIf2CJL.js";/* empty css              */import"./VAvatar-BC1zbJAc.js";import"./VImg-jU4EjX8n.js";import"./forwardRefs-B7WXio9P.js";const Q={width:"60%"},X={class:"text-white"},Z={class:"text-center"},ee={class:"text-center"},ae={key:1},te={class:"text-center"},Ve={__name:"erapor",async setup(le){let f,V;M({title:`Kirim Data e-Rapor | ${U.app.title}`});const{data:m,execute:$}=([f,V]=j(()=>Y(z("/sinkronisasi/erapor",{query:{sekolah_id:o.sekolah_id,semester_id:o.semester.semester_id,user_id:o.user_id}}))),f=await f,V(),f),N=k(()=>m.value.last_sync),T=k(()=>m.value.table_sync),c=k(()=>m.value.jumlah),b=k(()=>{var r;return(r=m.value.response)==null?void 0:r.error}),B=k(()=>{var r;return(r=m.value.response)==null?void 0:r.message}),u=D(!1);c.value>1e3&&(u.value=!0);const h=D(!1),P=async()=>{h.value=!0,await O("/sinkronisasi/kirim-data",{method:"POST",body:{sekolah_id:o.sekolah_id,semester_id:o.semester.semester_id,user_id:o.user_id},onResponse({request:r,response:a,options:v}){let p=a._data;h.value=!1,J.fire({icon:p.icon,title:p.title,text:p.text}).then(d=>{$()})}})};return(r,a)=>{const v=I("font-awesome-icon"),p=R;return g(),_("div",null,[l(x,null,{default:n(()=>[l(w,{cols:"6",xl:"8",md:"8",sm:"6"},{default:n(()=>[l(y,null,{default:n(()=>[l(A,{class:"text-no-wrap"},{default:n(()=>[e("tbody",null,[e("tr",null,[a[2]||(a[2]=e("td",{rowspan:"3",width:"10%",style:{"border-right":"1px solid #dddddd"}},[e("img",{src:"/images/logo/logo-small.png",alt:"Logo e-Rapor SMK",style:{"max-width":"100px"}})],-1)),a[3]||(a[3]=e("td",{width:"30%"},"   NPSN Sekolah",-1)),e("td",Q,i(("$user"in r?r.$user:s(o)).sekolah.npsn),1)]),e("tr",null,[a[4]||(a[4]=e("td",null,"Nama Sekolah",-1)),e("td",null,i(("$user"in r?r.$user:s(o)).sekolah.alamat),1)]),e("tr",null,[a[5]||(a[5]=e("td",null,"Desa Kelurahan Sekolah",-1)),e("td",null,i(("$user"in r?r.$user:s(o)).sekolah.desa_kelurahan),1)])])]),_:1})]),_:1})]),_:1}),l(w,{cols:"6",xl:"4",md:"4",sm:"6"},{default:n(()=>[l(y,null,{default:n(()=>[l(K,{class:"text-center"},{default:n(()=>[e("p",null,[a[6]||(a[6]=t("Pengiriman data terakhir dilakukan pada ")),a[7]||(a[7]=e("br",null,null,-1)),e("strong",null,i(s(N)),1)]),l(L,{loading:s(h),disabled:s(h)||s(b)||!s(c),size:"large",color:"success",onClick:P},{default:n(()=>[l(v,{icon:"fa-solid fa-cloud-arrow-up"}),a[8]||(a[8]=t("   ")),a[9]||(a[9]=e("strong",null,"KIRIM DATA",-1))]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),l(x,null,{default:n(()=>[l(w,{cols:"12"},{default:n(()=>[l(S,{color:"secondary",class:"text-center"},{default:n(()=>a[10]||(a[10]=[e("h3",{class:"text-white"},"DATA YANG MENGALAMI PERUBAHAN",-1)])),_:1}),s(b)?(g(),E(S,{key:0,color:"error",class:"text-center mt-4"},{default:n(()=>[e("h3",X,i(s(B)),1)]),_:1})):H("",!0)]),_:1})]),_:1}),l(x,null,{default:n(()=>[l(w,{cols:"12"},{default:n(()=>[l(y,null,{default:n(()=>[l(A,{class:"text-no-wrap"},{default:n(()=>[a[13]||(a[13]=e("thead",null,[e("tr",null,[e("th",{class:"text-center",width:"5%"},"No"),e("th",{width:"80%"},"Data"),e("th",{class:"text-center",width:"15%"},"Jml Data")])],-1)),e("tbody",null,[s(c)?(g(!0),_(q,{key:0},F(s(T),(d,C)=>(g(),_("tr",{key:C},[e("td",Z,i(C+1),1),e("td",null,i(d.data),1),e("td",ee,i(d.count),1)]))),128)):(g(),_("tr",ae,a[11]||(a[11]=[e("td",{colspan:"3",class:"text-center"},"Tidak ada data yang mengalami perubahan",-1)])))]),e("tfoot",null,[e("tr",null,[a[12]||(a[12]=e("th",{colspan:"2",class:"text-right"},"Jumlah",-1)),e("th",te,i(s(c)),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),l(W,{modelValue:s(u),"onUpdate:modelValue":a[1]||(a[1]=d=>G(u)?u.value=d:null),width:"800"},{default:n(()=>[l(p,{onClick:a[0]||(a[0]=d=>u.value=!s(u))}),l(y,{title:"Informasi"},{default:n(()=>[l(K,null,{default:n(()=>a[14]||(a[14]=[e("p",null,[t("Terdeteksi jumlah data yang akan dikirim melebihi 1.000 row. Sangat disarankan melakukan pengiriman data melalui "),e("code",null,"Command Prompt"),t(" untuk menghindari kegagalan pengiriman data.")],-1),e("p",null,[t("Cara melakukan pengiriman data melalui "),e("code",null,"Command Prompt"),t(":")],-1),e("p",null,[t("Untuk Pengguna "),e("strong",null,"Windows")],-1),e("ol",{style:{"padding-left":"20px"}},[e("li",null,"Buka CMD"),e("li",null,[t("Ketik: "),e("code",null,"cd c:\\eRaporSMK\\dataweb"),t(" [enter]")]),e("li",null,[t("Ketik: "),e("code",null,"php artisan kirim:erapor"),t(" [enter]")]),e("li",null,"Ketikkan email administrator"),e("li",null,"Tunggu hingga proses pengiriman data selesai.")],-1),e("p",null,[t("Untuk Pengguna "),e("strong",null,"Linux")],-1),e("ol",{style:{"padding-left":"20px"}},[e("li",null,[t("Buka Aplikasi Putty dan login ke "),e("code",null,"shh")]),e("li",null,[t("Ketik: "),e("code",null,[t("cd /var/www/html/dataweb"),e("sup",null,"*")]),t(" [enter]")]),e("li",null,[t("Ketik: "),e("code",null,"php artisan kirim:erapor"),t(" [enter]")]),e("li",null,"Ketikkan email administrator"),e("li",null,"Tunggu hingga proses pengiriman data selesai.")],-1),e("p",null,[t("Keterangan: "),e("br"),t(" * : Sesuaikan dengan direktori root folder aplikasi e-Rapor SMK di install "),e("br"),t(" Untuk mengirimkan seluruh data yang tersimpan di database tanpa filter apapun, jalankan perintah: "),e("code",null,"php artisan kirim:erapor --force")],-1)])),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{Ve as default};
